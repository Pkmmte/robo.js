/*! For license information please see 33178141.9e5737a7.js.LICENSE.txt */
"use strict";(self.webpackChunkrobo_js_docs=self.webpackChunkrobo_js_docs||[]).push([[9917],{2785:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>j,frontMatter:()=>d,metadata:()=>c,toc:()=>h});var n=s(5893),t=s(1151),i=s(5396),o=s(352);const d={image:"https://preview.robojs.dev?path=/plugins/server"},l="@robojs/server",c={id:"plugins/server",title:"@robojs/server",description:"Elevate your Robo.js project with @robojs/server, a powerful plugin that provides an effortless way to create and manage web routes. This guide will walk you through the essentials of setting up and using the API plugin.",source:"@site/docs/plugins/server.mdx",sourceDirName:"plugins",slug:"/plugins/server",permalink:"/plugins/server",draft:!1,unlisted:!1,editUrl:"https://github.com/Wave-Play/robo.js/edit/main/docs/docs/plugins/server.mdx",tags:[],version:"current",lastUpdatedBy:"Pkmmte Xeleon",lastUpdatedAt:1715553501e3,frontMatter:{image:"https://preview.robojs.dev?path=/plugins/server"},sidebar:"tutorialSidebar",previous:{title:"@robojs/moderation",permalink:"/plugins/moderation"},next:{title:"@robojs/sync",permalink:"/plugins/sync"}},a={},h=[{value:"Installation \ud83d\udcbb",id:"installation-",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Routing",id:"routing",level:2},{value:"Usage",id:"usage",level:2},{value:"Throwable Responses",id:"throwable-responses",level:3},{value:"API Reference",id:"api-reference",level:3},{value:"RoboRequest",id:"roborequest",level:3},{value:"Reply",id:"reply",level:3},{value:"Plugin Configuration",id:"plugin-configuration",level:2},{value:"Server Engine",id:"server-engine",level:2},{value:"More on GitHub",id:"more-on-github",level:2}];function u(e){const r={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h1,{id:"robojsserver",children:"@robojs/server"}),"\n",(0,n.jsxs)(r.p,{children:["Elevate your Robo.js project with ",(0,n.jsx)(r.code,{children:"@robojs/server"}),", a powerful plugin that provides an effortless way to create and manage web routes. This guide will walk you through the essentials of setting up and using the API plugin."]}),"\n",(0,n.jsxs)(r.blockquote,{children:["\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"Heads up!"})," RoboPlay Pods are currently optimized for bots and do not support API servers. This will be supported in the coming weeks."]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"installation-",children:"Installation \ud83d\udcbb"}),"\n",(0,n.jsx)(r.p,{children:"To add this plugin to your Robo.js project:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"npx robo add @robojs/server\n"})}),"\n",(0,n.jsx)(r.p,{children:"New to Robo.js? Start your project with this plugin pre-installed:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"npx create-robo <project-name> -p @robojs/server\n"})}),"\n",(0,n.jsx)(r.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,n.jsxs)(r.p,{children:["Create a new API route by adding a file in ",(0,n.jsx)(r.code,{children:"/src/api"}),". For example, creating ",(0,n.jsx)(r.code,{children:"hello.js"})," with the following content:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"export default () => {\n\treturn 'Hello World!'\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Now, run your Robo and visit ",(0,n.jsx)(r.code,{children:"http://localhost:3000/api/hello"})," to see the route in action."]}),"\n",(0,n.jsx)(r.h2,{id:"routing",children:"Routing"}),"\n",(0,n.jsxs)(r.p,{children:["Routes are created based on your file structure within ",(0,n.jsx)(r.code,{children:"/src/api"}),". The path to the file translates to the route URL. For example:"]}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"test.js"})," \u2192 ",(0,n.jsx)(r.code,{children:"/api/test"})]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"auth/sign-in.js"})," \u2192 ",(0,n.jsx)(r.code,{children:"/api/auth/sign-in"})]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"user/[id]/dashboard.js"})," \u2192 ",(0,n.jsx)(r.code,{children:"/api/user/:id/dashboard"})]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:["Default routes are prefixed with ",(0,n.jsx)(r.code,{children:"/api"}),". You can modify this prefix in the plugin's config file by setting the ",(0,n.jsx)(r.code,{children:"prefix"})," field to ",(0,n.jsx)(r.code,{children:"null"})," or ",(0,n.jsx)(r.code,{children:"false"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsx)(r.p,{children:"Each route file should export a default function. This function handles HTTP requests and can return a response directly."}),"\n",(0,n.jsxs)(r.p,{children:["The function receives two parameters: ",(0,n.jsx)(r.code,{children:"request"})," and ",(0,n.jsx)(r.code,{children:"reply"}),". These objects provide methods to interact with the request and response."]}),"\n",(0,n.jsx)(r.p,{children:"Example 1: Simple GET request"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"export default (request, reply) => {\n\tif (request.method !== 'GET') {\n\t\tthrow new Error('Method not allowed')\n\t}\n\n\tconst userId = request.params.id\n\n\t// ... perform some action with userId\n\n\treturn { message: `User ID is ${userId}` }\n}\n"})}),"\n",(0,n.jsx)(r.p,{children:"Example 2: POST request with body parsing"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"export default async (request, reply) => {\n\tif (request.method !== 'POST') {\n\t\treply.status(405).send('Method not allowed')\n\t\treturn\n\t}\n\n\tconst userData = await request.json()\n\n\t// ... interact with database, e.g., Prisma\n\n\treply.status(200).send(JSON.stringify({ success: true, userData }))\n}\n"})}),"\n",(0,n.jsx)(r.p,{children:"Returning a value from the route function will automatically send a response with the value as the body. The same is true for throwing an error."}),"\n",(0,n.jsxs)(r.p,{children:["If you need to manually send a response, use the ",(0,n.jsx)(r.code,{children:"reply"})," object. This object provides methods to set the status code, headers, and body."]}),"\n",(0,n.jsxs)(r.p,{children:["Don't want to use Robo's wrappers? Access the raw request and response objects using ",(0,n.jsx)(r.code,{children:"request.req"})," and ",(0,n.jsx)(r.code,{children:"reply.res"}),"."]}),"\n",(0,n.jsx)(r.h3,{id:"throwable-responses",children:"Throwable Responses"}),"\n",(0,n.jsx)(r.p,{children:"Did you know that throwing an error in your route function will automatically send a response with the error message? This is a handy way to handle errors in your API routes."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"export default (request, reply) => {\n\tif (!request.query.key) {\n\t\tthrow new Error('API key is required')\n\t}\n\n\t// ... perform some action with the key\n\n\treturn { message: 'Success!' }\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["What's more, you can customize the response by throwing a ",(0,n.jsx)(r.code,{children:"RoboResponse"})," object. This object allows you to set the status code, headers, and body of the response. It has the same effect as returning it."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-javascript",children:"export default (request, reply) => {\n\tif (!request.query.key) {\n\t\tthrow new RoboResponse({\n\t\t\tstatusCode: 401,\n\t\t\theaders: { 'WWW-Authenticate': 'Bearer' },\n\t\t\tbody: 'Unauthorized'\n\t\t})\n\t}\n\n\t// ... perform some action with the key\n\n\treturn RoboResponse.json({ message: 'Success!' })\n}\n"})}),"\n",(0,n.jsx)(r.h3,{id:"api-reference",children:"API Reference"}),"\n",(0,n.jsxs)(r.p,{children:["Here's a detailed breakdown of the methods and properties available in the ",(0,n.jsx)(r.code,{children:"request"})," and ",(0,n.jsx)(r.code,{children:"reply"})," objects, along with their TypeScript types:"]}),"\n",(0,n.jsx)(r.h3,{id:"roborequest",children:"RoboRequest"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.strong,{children:"RoboRequest"})," extends the ",(0,n.jsx)(r.strong,{children:(0,n.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Request",children:"Web Request API"})})," and provides additional properties and methods for handling requests."]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Method/Property"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Type"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Description"})})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"req"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"IncomingMessage"})}),(0,n.jsx)(r.td,{children:"Raw request object."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"json"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"unknown"})}),(0,n.jsx)(r.td,{children:"Parse the request body as JSON."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"method"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"HttpMethod"})}),(0,n.jsx)(r.td,{children:"Get the HTTP method."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"query"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"Record<string, string | string[]>"})}),(0,n.jsx)(r.td,{children:"Access query parameters."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"params"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"Record<string, unknown>"})}),(0,n.jsx)(r.td,{children:"Get URL parameters."})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"reply",children:"Reply"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Method/Property"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Type"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Description"})})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"res"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"ServerResponse"})}),(0,n.jsx)(r.td,{children:"Raw response object."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"code"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"(statusCode: number) => RoboReply"})}),(0,n.jsx)(r.td,{children:"Set the HTTP status code."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"send"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"(data: string) => RoboReply"})}),(0,n.jsx)(r.td,{children:"Send the response content."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"header"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"(name: string, value: string) => RoboReply"})}),(0,n.jsx)(r.td,{children:"Set a response header."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hasSent"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"boolean"})}),(0,n.jsx)(r.td,{children:"Indicates if the response has been sent."})]})]})]}),"\n",(0,n.jsx)(r.p,{children:"These types can be imported from the plugin's package for enhanced TypeScript support."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-ts",children:"import type { RoboRequest, RoboReply } from '@robojs/server'\n"})}),"\n",(0,n.jsx)(r.h2,{id:"plugin-configuration",children:"Plugin Configuration"}),"\n",(0,n.jsx)(r.p,{children:"Customize your API plugin using these config fields:"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Config Field"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Type"})}),(0,n.jsx)(r.th,{children:(0,n.jsx)(r.strong,{children:"Description"})})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"hostname"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"string"})}),(0,n.jsx)(r.td,{children:"The hostname on which the server will run."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"port"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"number"})}),(0,n.jsx)(r.td,{children:"The port on which the server will listen."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"prefix"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"string/false"})}),(0,n.jsx)(r.td,{children:"Custom URL prefix for routes or disable it."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"engine"})}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"BaseServer"})}),(0,n.jsx)(r.td,{children:"Custom server engine implementation."})]})]})]}),"\n",(0,n.jsx)(r.p,{children:"Example:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",metastring:'title="config/plugins/robojs/server.mjs"',children:"// File: /config/plugins/robojs/server.mjs\nexport default {\n\thostname: '0.0.0.0', // Defaults to 'localhost'\n\tport: 5000, // Custom port\n\tprefix: false, // Disable the '/api' prefix\n\tengine: CustomServer // Custom server engine\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["In this configuration, ",(0,n.jsx)(r.code,{children:"port"})," is set to ",(0,n.jsx)(r.code,{children:"5000"}),", ",(0,n.jsx)(r.code,{children:"prefix"})," is disabled (routes will not have the ",(0,n.jsx)(r.code,{children:"/api"})," prefix), and a custom server engine is specified."]}),"\n",(0,n.jsxs)(r.p,{children:["Alternatively, use the ",(0,n.jsx)(r.code,{children:"PORT"})," environment variable."]}),"\n",(0,n.jsx)(r.h2,{id:"server-engine",children:"Server Engine"}),"\n",(0,n.jsxs)(r.p,{children:["The API plugin uses Node's ",(0,n.jsx)(r.code,{children:"http"})," module by default. If you have Fastify installed, it will automatically switch to Fastify for enhanced performance."]}),"\n",(0,n.jsxs)(r.p,{children:["You can create your own server engine by extending the ",(0,n.jsx)(r.code,{children:"BaseServer"})," class and implementing its abstract methods. Then, specify your custom server engine in the plugin's config file."]}),"\n",(0,n.jsx)(r.h2,{id:"more-on-github",children:"More on GitHub"}),"\n",(0,n.jsx)(o._,{children:(0,n.jsx)(i.Z,{href:"https://github.com/Wave-Play/robo.js/tree/main/packages/plugin-api",title:"\ud83d\udd17 GitHub Repository",description:"Explore source code on GitHub."})})]})}function j(e={}){const{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},5396:(e,r,s)=>{s.d(r,{Z:()=>o});var n=s(7294),t=s(3692),i=s(2503);const o=e=>{const{description:r,href:s,title:o}=e;return n.createElement(t.Z,{className:"col col--6 nodecor margin-bottom--lg",to:s},n.createElement("div",{className:"card padding--lg cardContent"},n.createElement(i.Z,{as:"h4",className:"text--truncate cardTitle"},o),n.createElement("p",{className:"text--truncate cardDescription"},r)))}},352:(e,r,s)=>{s.d(r,{_:()=>t});var n=s(7294);const t=e=>{const{children:r}=e;return n.createElement("div",{className:"row cardContainer"},r)}},5251:(e,r,s)=>{var n=s(7294),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,d=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,r,s){var n,i={},c=null,a=null;for(n in void 0!==s&&(c=""+s),void 0!==r.key&&(c=""+r.key),void 0!==r.ref&&(a=r.ref),r)o.call(r,n)&&!l.hasOwnProperty(n)&&(i[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===i[n]&&(i[n]=r[n]);return{$$typeof:t,type:e,key:c,ref:a,props:i,_owner:d.current}}r.Fragment=i,r.jsx=c,r.jsxs=c},5893:(e,r,s)=>{e.exports=s(5251)},1151:(e,r,s)=>{s.d(r,{Z:()=>d,a:()=>o});var n=s(7294);const t={},i=n.createContext(t);function o(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);